<html>
<head>
</head>
<body style="overflow-wrap: break-word;" onfocusout="parent.setEmailRange();">
    <div id="div1">

    </div>
    <script src="../js/buildprovisiontext.js"></script>
    <script language="javascript">
        provisionName = "SATR 10"
        langId = 1033
        parent.Xrm.WebApi.retrieveMultipleRecords("qm_rclegislation", `?$select=qm_name,qm_legislationlbl,qm_legislationetxt,qm_legislationftxt,_qm_tylegislationtypeid_value,_qm_rcparentlegislationid_value&$filter=qm_name eq '${provisionName}'`).then(
            async function success(result) {
                if (result.entities.length > 0) {
                    provisionText = await buildProvisionText(result.entities[0], langId);
                    var span = document.createElement("Span");
                    span.innerHTML = provisionText;
                    document.getElementById("div1").appendChild(span);
                }
            },
            function (error) {
                console.log(error.message);
                // handle error conditions
            }
        );

        
    </script>
</body>
</html>